<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="generator" content="Observable Framework v1.13.3">
<title>Climate &amp; Environment Data Portal</title>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Source+Serif+4:ital,opsz,wght@0,8..60,200..900;1,8..60,200..900&amp;display=swap" crossorigin>
<link rel="preload" as="style" href="./_import/style.7a7f6120.css">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css2?family=Source+Serif+4:ital,opsz,wght@0,8..60,200..900;1,8..60,200..900&amp;display=swap" crossorigin>
<link rel="stylesheet" type="text/css" href="./_import/style.7a7f6120.css">
<link rel="modulepreload" href="./_observablehq/client.3714645d.js">
<link rel="modulepreload" href="./_observablehq/runtime.e080113b.js">
<link rel="modulepreload" href="./_observablehq/stdlib.73a8ec5a.js">
<link rel="modulepreload" href="./_npm/d3@7.9.0/e780feca.js">
<link rel="modulepreload" href="./_npm/htl@0.3.1/72f4716c.js">
<link rel="modulepreload" href="./_npm/@observablehq/plot@0.6.17/d761ef9b.js">
<link rel="modulepreload" href="./_npm/d3-dsv@3.0.1/9cffc2bd.js">
<link rel="modulepreload" href="./_npm/d3-array@3.2.4/e93ca09f.js">
<link rel="modulepreload" href="./_npm/d3-axis@3.0.0/0f2de24d.js">
<link rel="modulepreload" href="./_npm/d3-brush@3.0.0/65eb105b.js">
<link rel="modulepreload" href="./_npm/d3-chord@3.0.1/7ef8fb2e.js">
<link rel="modulepreload" href="./_npm/d3-color@3.1.0/aeb57b94.js">
<link rel="modulepreload" href="./_npm/d3-contour@4.0.2/1d2aed74.js">
<link rel="modulepreload" href="./_npm/d3-delaunay@6.0.4/5ced1d52.js">
<link rel="modulepreload" href="./_npm/d3-dispatch@3.0.1/9ba9c7f3.js">
<link rel="modulepreload" href="./_npm/d3-drag@3.0.0/4202580c.js">
<link rel="modulepreload" href="./_npm/d3-ease@3.0.1/cdd7e898.js">
<link rel="modulepreload" href="./_npm/d3-fetch@3.0.1/b4e2ad9a.js">
<link rel="modulepreload" href="./_npm/d3-force@3.0.0/5e804d15.js">
<link rel="modulepreload" href="./_npm/d3-format@3.1.0/86074ef6.js">
<link rel="modulepreload" href="./_npm/d3-geo@3.1.1/40599fb3.js">
<link rel="modulepreload" href="./_npm/d3-hierarchy@3.1.2/e49e792c.js">
<link rel="modulepreload" href="./_npm/d3-interpolate@3.0.1/8d1e5425.js">
<link rel="modulepreload" href="./_npm/d3-path@3.1.0/20d3f133.js">
<link rel="modulepreload" href="./_npm/d3-polygon@3.0.1/7553081f.js">
<link rel="modulepreload" href="./_npm/d3-quadtree@3.0.1/0dfd751c.js">
<link rel="modulepreload" href="./_npm/d3-random@3.0.1/3c90ee06.js">
<link rel="modulepreload" href="./_npm/d3-scale@4.0.2/843b6a76.js">
<link rel="modulepreload" href="./_npm/d3-scale-chromatic@3.1.0/ba24c2e7.js">
<link rel="modulepreload" href="./_npm/d3-selection@3.0.0/4d94e5b7.js">
<link rel="modulepreload" href="./_npm/d3-shape@3.2.0/6d3a6726.js">
<link rel="modulepreload" href="./_npm/d3-time@3.1.0/9f03c579.js">
<link rel="modulepreload" href="./_npm/d3-time-format@4.1.0/07c9626f.js">
<link rel="modulepreload" href="./_npm/d3-timer@3.0.1/b58a267d.js">
<link rel="modulepreload" href="./_npm/d3-transition@3.0.1/004da2ac.js">
<link rel="modulepreload" href="./_npm/d3-zoom@3.0.0/b5786b3f.js">
<link rel="modulepreload" href="./_npm/isoformat@0.2.1/18cbf477.js">
<link rel="modulepreload" href="./_npm/interval-tree-1d@1.0.4/53fe8176.js">
<link rel="modulepreload" href="./_npm/internmap@2.0.3/e08981d9.js">
<link rel="modulepreload" href="./_npm/delaunator@5.0.1/02d43215.js">
<link rel="modulepreload" href="./_npm/binary-search-bounds@2.0.5/cbf6ba23.js">
<link rel="modulepreload" href="./_npm/robust-predicates@3.0.2/aa00730b.js">

  <link rel="icon" href="./_file/observable.1af93621.png" type="image/png" sizes="32x32">
  <script>
    sessionStorage.setItem("observablehq-sidebar", "false");
  </script>
  <script type="module">
    import { inject } from 'https://esm.sh/@vercel/analytics@1.5.0';
    inject();
  </script>
  
<script type="module">

import {define} from "./_observablehq/client.3714645d.js";
import {registerFile} from "./_observablehq/stdlib.73a8ec5a.js";

registerFile("./data/CSIRO_Recons_gmsl_yr_2019.csv", {"name":"./data/CSIRO_Recons_gmsl_yr_2019.csv","mimeType":"text/csv","path":"./_file/data/CSIRO_Recons_gmsl_yr_2019.4cf6e74a.csv","lastModified":1760221256949,"size":2111});
registerFile("./data/co2-mm-mlo.csv", {"name":"./data/co2-mm-mlo.csv","mimeType":"text/csv","path":"./_file/data/co2-mm-mlo.894efb21.csv","lastModified":1761137951924,"size":37957});
registerFile("./data/glaciers.csv", {"name":"./data/glaciers.csv","mimeType":"text/csv","path":"./_file/data/glaciers.95ba15b3.csv","lastModified":1761742928017,"size":1160});
registerFile("./data/global-temp-annual.csv", {"name":"./data/global-temp-annual.csv","mimeType":"text/csv","path":"./_file/data/global-temp-annual.6d5c6fee.csv","lastModified":1761743599893,"size":6335});

define({id: "f9677068", inputs: ["FileAttachment"], outputs: ["globalTempRaw","csiroRaw","glaciersRaw","co2Raw"], body: (FileAttachment) => {
const globalTempRaw = FileAttachment("./data/global-temp-annual.csv").csv({typed: true});
const csiroRaw = FileAttachment("./data/CSIRO_Recons_gmsl_yr_2019.csv").csv({typed: true});
const glaciersRaw = FileAttachment("./data/glaciers.csv").csv({typed: true});
const co2Raw = FileAttachment("./data/co2-mm-mlo.csv").csv({typed: true});
return {globalTempRaw,csiroRaw,glaciersRaw,co2Raw};
}});

define({id: "b5853b2b", inputs: ["globalTempRaw","csiroRaw","glaciersRaw","co2Raw"], outputs: ["globalTempData","csiroData","glaciersData","co2Data","latestTemp","latestSeaLevel","latestGlacier","latestCO2","firstCO2","tempChange","seaLevelChange","glacierChange","co2Increase"], body: async (globalTempRaw,csiroRaw,glaciersRaw,co2Raw) => {
const globalTempData = (await globalTempRaw)
  .filter(d => d.Source === "GISTEMP")
  .map(d => ({ year: +d.Year, value: +d.Mean }))
  .filter(d => !isNaN(d.value) && d.year >= 1880);

const csiroData = (await csiroRaw).map(d => ({
  year: +d.Time,
  value: +d.GMSL
})).filter(d => d.year >= 1880 && !isNaN(d.value));

const glaciersData = (await glaciersRaw).map(d => ({
  year: +d.Year,
  value: +d["Mean cumulative mass balance"]
})).filter(d => !isNaN(d.value) && d.year >= 1956);

const co2Data = (await co2Raw).map(d => ({
  date: new Date(d.Date),
  year: d["Decimal Date"],
  yearInt: Math.floor(d["Decimal Date"]),
  average: +d.Average
})).filter(d => !isNaN(d.average) && d.average > 0);

const latestTemp = globalTempData[globalTempData.length - 1];
const latestSeaLevel = csiroData[csiroData.length - 1];
const latestGlacier = glaciersData[glaciersData.length - 1];
const latestCO2 = co2Data[co2Data.length - 1];
const firstCO2 = co2Data[0];

const tempChange = latestTemp.value - globalTempData[0].value;
const seaLevelChange = latestSeaLevel.value - csiroData[0].value;
const glacierChange = latestGlacier.value - glaciersData[0].value;
const co2Increase = latestCO2.average - firstCO2.average;
return {globalTempData,csiroData,glaciersData,co2Data,latestTemp,latestSeaLevel,latestGlacier,latestCO2,firstCO2,tempChange,seaLevelChange,glacierChange,co2Increase};
}});

define({id: "5eaf4c2e", inputs: ["display","html","latestCO2","tempChange","seaLevelChange","glacierChange","resize","d3","globalTempData","csiroData","Plot","co2Data","glaciersData"], body: (display,html,latestCO2,tempChange,seaLevelChange,glacierChange,resize,d3,globalTempData,csiroData,Plot,co2Data,glaciersData) => {
display(html`<div class="dashboard-container">
  <div class="dashboard-top">
    <div class="sidebar-section">
      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-card-header">
            <span class="stat-card-label">Current CO₂</span>
          </div>
          <div class="stat-card-content">
            <div class="stat-card-value">${latestCO2.average.toFixed(0)}</div>
            <div class="stat-card-subvalue">PPM</div>
          </div>
        </div>

        <div class="stat-card">
          <div class="stat-card-header">
            <span class="stat-card-label">Temp Rise</span>
          </div>
          <div class="stat-card-content">
            <div class="stat-card-value" style="color: var(--color-accent-red)">+${tempChange.toFixed(2)}°C</div>
            <div class="stat-card-subvalue">Since 1880</div>
          </div>
        </div>

        <div class="stat-card">
          <div class="stat-card-header">
            <span class="stat-card-label">Sea Level</span>
          </div>
          <div class="stat-card-content">
            <div class="stat-card-value" style="color: var(--color-accent-blue)">+${seaLevelChange.toFixed(0)}</div>
            <div class="stat-card-subvalue">mm Rise</div>
          </div>
        </div>

        <div class="stat-card">
          <div class="stat-card-header">
            <span class="stat-card-label">Glaciers</span>
          </div>
          <div class="stat-card-content">
            <div class="stat-card-value" style="color: var(--color-accent-orange)">${glacierChange.toFixed(1)}</div>
            <div class="stat-card-subvalue">Meters (w.e.)</div>
          </div>
        </div>
      </div>

      <div class="insights-card">
        <div class="insights-header">
          <h4 class="insights-title">Key Insights</h4>
        </div>
        <ul class="insights-list">
          <li>CO₂ concentrations are at their highest level in human history (~${latestCO2.average.toFixed(0)} PPM)</li>
          <li>Global temperatures have risen ${tempChange.toFixed(2)}°C, driving extreme weather events</li>
          <li>Sea levels are rising at an accelerating rate due to thermal expansion and ice melt</li>
          <li>Glaciers are retreating globally, threatening freshwater supplies</li>
        </ul>
      </div>
    </div>

    <div class="chart-card">
      <div class="chart-header">
        <div class="chart-title-row">
          <h3 class="chart-title">Global Temperature & Sea Level Rise (1880-2019)</h3>
        </div>
      </div>
      <div class="chart-content">
        ${resize((width) => {
          const isMobile = width < 640;
          const height = isMobile ? 320 : 380;
          const marginTop = 20;
          const marginRight = isMobile ? 50 : 60;
          const marginBottom = isMobile ? 50 : 40;
          const marginLeft = isMobile ? 50 : 60;

          const container = d3.create("div").style("position", "relative");
          const svg = container.append("svg")
            .attr("width", width).attr("height", height)
            .attr("viewBox", [0, 0, width, height])
            .style("overflow", "visible");

          // Clipping path to prevent lines going off-chart
          svg.append("defs").append("clipPath")
            .attr("id", "chart-clip")
            .append("rect")
            .attr("x", marginLeft)
            .attr("y", marginTop)
            .attr("width", width - marginLeft - marginRight)
            .attr("height", height - marginBottom - marginTop);

          const xScale = d3.scaleLinear().domain([1880, 2019]).range([marginLeft, width - marginRight]);

          const yTempScale = d3.scaleLinear()
            .domain([d3.min(globalTempData, d => d.value), d3.max(globalTempData, d => d.value)])
            .range([height - marginBottom, marginTop]).nice();

          const ySeaLevelScale = d3.scaleLinear()
            .domain([d3.min(csiroData, d => d.value), d3.max(csiroData, d => d.value)])
            .range([height - marginBottom, marginTop]).nice();

          const lineTemp = d3.line().x(d => xScale(d.year)).y(d => yTempScale(d.value)).curve(d3.curveCatmullRom);
          const lineSeaLevel = d3.line().x(d => xScale(d.year)).y(d => ySeaLevelScale(d.value)).curve(d3.curveCatmullRom);

          // Grid
          svg.append("g").attr("transform", `translate(${marginLeft},0)`)
            .call(d3.axisLeft(yTempScale).tickSize(-(width - marginLeft - marginRight)).tickFormat(""))
            .call(g => g.select(".domain").remove())
            .call(g => g.selectAll(".tick line").attr("stroke", "#e5e7eb").attr("stroke-opacity", 0.5));

          // Axes
          svg.append("g").attr("transform", `translate(0,${height - marginBottom})`)
            .call(d3.axisBottom(xScale).tickFormat(d3.format("d")));

          svg.append("g").attr("transform", `translate(${marginLeft},0)`)
            .call(d3.axisLeft(yTempScale).tickFormat(d => `${d}°C`))
            .call(g => g.selectAll("text").attr("fill", "#dc2626").attr("font-weight", "bold"));

          svg.append("g").attr("transform", `translate(${width - marginRight},0)`)
            .call(d3.axisRight(ySeaLevelScale).tickFormat(d => `${d}mm`))
            .call(g => g.selectAll("text").attr("fill", "#1d4ed8").attr("font-weight", "bold"));

          // Lines with clipping
          svg.append("path")
            .datum(globalTempData)
            .attr("fill", "none")
            .attr("stroke", "#dc2626")
            .attr("stroke-width", 2.5)
            .attr("d", lineTemp)
            .attr("clip-path", "url(#chart-clip)");

          svg.append("path")
            .datum(csiroData)
            .attr("fill", "none")
            .attr("stroke", "#1d4ed8")
            .attr("stroke-width", 2.5)
            .attr("d", lineSeaLevel)
            .attr("clip-path", "url(#chart-clip)");

          // Legend
          const legend = svg.append("g").attr("transform", `translate(${marginLeft + 20}, ${marginTop + 10})`);
          legend.append("rect").attr("width", 140).attr("height", 50).attr("fill", "white").attr("fill-opacity", 0.8).attr("rx", 4);

          legend.append("line").attr("x1", 10).attr("x2", 30).attr("y1", 20).attr("y2", 20).attr("stroke", "#dc2626").attr("stroke-width", 2.5);
          legend.append("text").attr("x", 35).attr("y", 24).text("Temperature").attr("font-size", "11px").attr("font-weight", "600");

          legend.append("line").attr("x1", 10).attr("x2", 30).attr("y1", 38).attr("y2", 38).attr("stroke", "#1d4ed8").attr("stroke-width", 2.5);
          legend.append("text").attr("x", 35).attr("y", 42).text("Sea Level").attr("font-size", "11px").attr("font-weight", "600");

          return container.node();
        })}
      </div>
    </div>
  </div>

  <div class="dashboard-bottom" style="grid-template-columns: 1fr 1fr;">
    <div class="chart-card">
      <div class="chart-header"><h3 class="chart-title">The Keeling Curve (CO₂)</h3></div>
      <div class="chart-content">
        ${resize((width) => Plot.plot({
          width, height: 300, marginLeft: 50, marginBottom: 40,
          y: { grid: true, label: "CO₂ (PPM)", domain: [300, 430] },
          marks: [
            Plot.areaY(co2Data, {x: "date", y: "average", fill: "#0ea5e9", fillOpacity: 0.1}),
            Plot.line(co2Data, {x: "date", y: "average", stroke: "#0ea5e9", strokeWidth: 2}),
            Plot.ruleY([350], {stroke: "#f59e0b", strokeDasharray: "4,4"}),
            Plot.text(["Safe Limit (350)"], {x: d3.max(co2Data, d => d.date), y: 350, dy: -6, textAnchor: "end", fill: "#f59e0b"})
          ]
        }))}
      </div>
    </div>

    <div class="chart-card">
      <div class="chart-header"><h3 class="chart-title">Glacier Mass Balance</h3></div>
      <div class="chart-content">
        ${resize((width) => {
           const glacierTempData = glaciersData.map(d => ({
            year: d.year, glacier: d.value,
            temp: globalTempData.find(t => t.year === d.year)?.value
          })).filter(d => d.temp !== undefined);
          return Plot.plot({
            width, height: 300, marginLeft: 50, marginBottom: 40,
            x: { label: "Temp Anomaly (°C)", grid: true },
            y: { label: "Glacier Mass (m)", grid: true },
            color: { scheme: "YlOrRd" },
            marks: [
              Plot.dot(glacierTempData, {x: "temp", y: "glacier", fill: "year", r: 4, tip: true }),
              Plot.linearRegressionY(glacierTempData, {x: "temp", y: "glacier", stroke: "black", strokeDasharray: "4,4"})
            ]
          });
        })}
      </div>
    </div>
  </div>

  <div class="dashboard-bottom" style="grid-template-columns: 1fr 1fr;">
    <div class="chart-card">
      <div class="chart-header"><h3 class="chart-title">Annual CO₂ Increase Rate</h3></div>
      <div class="chart-content">
        ${resize((width) => {
          const yearlyAverage = d3.rollups(co2Data, v => d3.mean(v, d => d.average), d => d.yearInt)
            .map(([year, avg]) => ({ year, average: avg })).sort((a, b) => a.year - b.year);
          const yearlyRates = yearlyAverage.slice(1).map((d, i) => ({
            year: d.year, rate: d.average - yearlyAverage[i].average
          }));
          return Plot.plot({
            width, height: 260, marginLeft: 50, marginBottom: 40,
            y: { label: "PPM/Year", grid: true, nice: true, clamp: true },
            marks: [
              Plot.ruleY([0]),
              Plot.areaY(yearlyRates, {x: "year", y: "rate", fill: "#dc2626", fillOpacity: 0.1, curve: "catmull-rom"}),
              Plot.line(yearlyRates, {x: "year", y: "rate", stroke: "#dc2626", strokeWidth: 2, curve: "catmull-rom", clip: true}),
              Plot.dot(yearlyRates, {x: "year", y: "rate", r: 2, fill: "transparent", tip: true})
            ]
          });
        })}
      </div>
    </div>

    <div class="chart-card">
      <div class="chart-header"><h3 class="chart-title">Critical CO₂ Thresholds</h3></div>
      <div class="chart-content">
        ${resize((width) => {
          // Horizontal Gauge / Thermometer Style
          const height = 260;
          const container = d3.create("div").style("position", "relative");
          const svg = container.append("svg").attr("width", width).attr("height", height).attr("viewBox", [0, 0, width, height]);

          const marginLeft=20, marginRight=20, marginTop=40, marginBottom=20;
          const chartWidth = width - marginLeft - marginRight;
          const barHeight = 60;
          const barY = 100;

          const xScale = d3.scaleLinear().domain([250, 500]).range([marginLeft, width - marginRight]);

          // Zones
          const zones = [
             {min: 250, max: 280, color: "#22c55e", label: "Pre-Industrial"},
             {min: 280, max: 350, color: "#f59e0b", label: "Safe"},
             {min: 350, max: 450, color: "#f97316", label: "Risk"},
             {min: 450, max: 500, color: "#dc2626", label: "Crisis"}
          ];

          // Draw zones
          zones.forEach(z => {
             svg.append("rect")
                .attr("x", xScale(z.min))
                .attr("y", barY)
                .attr("width", xScale(z.max) - xScale(z.min))
                .attr("height", barHeight)
                .attr("fill", z.color)
                .attr("fill-opacity", 0.3)
                .attr("stroke", "white");

             // Labels
             if (width > 400 || (z.label !== "Risk" && z.label !== "Safe")) {
                svg.append("text")
                   .attr("x", xScale(z.min) + 5)
                   .attr("y", barY + barHeight + 15)
                   .text(z.label)
                   .attr("font-size", "10px")
                   .attr("fill", "#555")
                   .attr("font-weight", "600");
             }
          });

          // Axis
          svg.append("g").attr("transform", `translate(0, ${barY})`)
             .call(d3.axisTop(xScale).tickValues([280, 350, 450]).tickFormat(d => d));

          // Current Value Marker
          const currentVal = latestCO2.average;
          const cx = xScale(currentVal);

          svg.append("line")
             .attr("x1", cx).attr("x2", cx)
             .attr("y1", barY - 10).attr("y2", barY + barHeight + 10)
             .attr("stroke", "#dc2626").attr("stroke-width", 3);

          // Current Value Label (Tooltip style box)
          const labelX = Math.min(Math.max(cx, marginLeft + 50), width - marginRight - 50);
          svg.append("rect")
             .attr("x", labelX - 45).attr("y", barY - 45)
             .attr("width", 90).attr("height", 30).attr("rx", 4)
             .attr("fill", "#dc2626");

          svg.append("text")
             .attr("x", labelX).attr("y", barY - 26)
             .attr("text-anchor", "middle")
             .attr("fill", "white")
             .attr("font-weight", "bold")
             .attr("font-size", "12px")
             .text(`${currentVal.toFixed(1)} PPM`);

          // Triangle pointer
          const path = d3.path();
          path.moveTo(cx, barY - 10);
          path.lineTo(cx - 6, barY - 16);
          path.lineTo(cx + 6, barY - 16);
          path.closePath();
          svg.append("path").attr("d", path).attr("fill", "#dc2626");

          return container.node();
        })}
      </div>
    </div>
  </div>

  <div class="dashboard-footer">
    <span>Built with Observable Framework</span>
    <span>Sources: NASA, CSIRO, WGMS, Scripps</span>
  </div>
</div>`)
}});

</script>
</head>
<body>
<div id="observablehq-center">
<main id="observablehq-main" class="observablehq">
<div class="observablehq observablehq--block"><!--:f9677068:--></div>
<div class="observablehq observablehq--block"><!--:b5853b2b:--></div>
<div class="observablehq observablehq--block"><observablehq-loading></observablehq-loading><!--:5eaf4c2e:--></div>
</main>
<footer id="observablehq-footer">
<nav><a rel="next" href="./co2-emissions-nations"><span>Global CO2 Emissions by Nation</span></a></nav>
<div>Built with Observable Framework. Sources: NASA GISTEMP, CSIRO, WGMS, Scripps CO₂.</div>
</footer>
</div>
</body>
</html>
