<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="generator" content="Observable Framework v1.13.3">
<title>Atmospheric COâ‚‚ Monitoring Dashboard | Climate &amp; Environment Data Portal</title>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Source+Serif+4:ital,opsz,wght@0,8..60,200..900;1,8..60,200..900&amp;display=swap" crossorigin>
<link rel="preload" as="style" href="./_import/style.7a7f6120.css">
<link rel="preload" as="style" href="./_observablehq/stdlib/inputs.ea9fd553.css">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css2?family=Source+Serif+4:ital,opsz,wght@0,8..60,200..900;1,8..60,200..900&amp;display=swap" crossorigin>
<link rel="stylesheet" type="text/css" href="./_import/style.7a7f6120.css">
<link rel="stylesheet" type="text/css" href="./_observablehq/stdlib/inputs.ea9fd553.css">
<link rel="modulepreload" href="./_observablehq/client.3714645d.js">
<link rel="modulepreload" href="./_observablehq/runtime.e080113b.js">
<link rel="modulepreload" href="./_observablehq/stdlib.73a8ec5a.js">
<link rel="modulepreload" href="./_npm/d3@7.9.0/e780feca.js">
<link rel="modulepreload" href="./_npm/htl@0.3.1/72f4716c.js">
<link rel="modulepreload" href="./_observablehq/stdlib/inputs.4ef1d259.js">
<link rel="modulepreload" href="./_npm/@observablehq/plot@0.6.17/d761ef9b.js">
<link rel="modulepreload" href="./_npm/d3-dsv@3.0.1/9cffc2bd.js">
<link rel="modulepreload" href="./_npm/isoformat@0.2.1/18cbf477.js">
<link rel="modulepreload" href="./_npm/d3-array@3.2.4/e93ca09f.js">
<link rel="modulepreload" href="./_npm/d3-axis@3.0.0/0f2de24d.js">
<link rel="modulepreload" href="./_npm/d3-brush@3.0.0/65eb105b.js">
<link rel="modulepreload" href="./_npm/d3-chord@3.0.1/7ef8fb2e.js">
<link rel="modulepreload" href="./_npm/d3-color@3.1.0/aeb57b94.js">
<link rel="modulepreload" href="./_npm/d3-contour@4.0.2/1d2aed74.js">
<link rel="modulepreload" href="./_npm/d3-delaunay@6.0.4/5ced1d52.js">
<link rel="modulepreload" href="./_npm/d3-dispatch@3.0.1/9ba9c7f3.js">
<link rel="modulepreload" href="./_npm/d3-drag@3.0.0/4202580c.js">
<link rel="modulepreload" href="./_npm/d3-ease@3.0.1/cdd7e898.js">
<link rel="modulepreload" href="./_npm/d3-fetch@3.0.1/b4e2ad9a.js">
<link rel="modulepreload" href="./_npm/d3-force@3.0.0/5e804d15.js">
<link rel="modulepreload" href="./_npm/d3-format@3.1.0/86074ef6.js">
<link rel="modulepreload" href="./_npm/d3-geo@3.1.1/40599fb3.js">
<link rel="modulepreload" href="./_npm/d3-hierarchy@3.1.2/e49e792c.js">
<link rel="modulepreload" href="./_npm/d3-interpolate@3.0.1/8d1e5425.js">
<link rel="modulepreload" href="./_npm/d3-path@3.1.0/20d3f133.js">
<link rel="modulepreload" href="./_npm/d3-polygon@3.0.1/7553081f.js">
<link rel="modulepreload" href="./_npm/d3-quadtree@3.0.1/0dfd751c.js">
<link rel="modulepreload" href="./_npm/d3-random@3.0.1/3c90ee06.js">
<link rel="modulepreload" href="./_npm/d3-scale@4.0.2/843b6a76.js">
<link rel="modulepreload" href="./_npm/d3-scale-chromatic@3.1.0/ba24c2e7.js">
<link rel="modulepreload" href="./_npm/d3-selection@3.0.0/4d94e5b7.js">
<link rel="modulepreload" href="./_npm/d3-shape@3.2.0/6d3a6726.js">
<link rel="modulepreload" href="./_npm/d3-time@3.1.0/9f03c579.js">
<link rel="modulepreload" href="./_npm/d3-time-format@4.1.0/07c9626f.js">
<link rel="modulepreload" href="./_npm/d3-timer@3.0.1/b58a267d.js">
<link rel="modulepreload" href="./_npm/d3-transition@3.0.1/004da2ac.js">
<link rel="modulepreload" href="./_npm/d3-zoom@3.0.0/b5786b3f.js">
<link rel="modulepreload" href="./_npm/interval-tree-1d@1.0.4/53fe8176.js">
<link rel="modulepreload" href="./_npm/internmap@2.0.3/e08981d9.js">
<link rel="modulepreload" href="./_npm/delaunator@5.0.1/02d43215.js">
<link rel="modulepreload" href="./_npm/binary-search-bounds@2.0.5/cbf6ba23.js">
<link rel="modulepreload" href="./_npm/robust-predicates@3.0.2/aa00730b.js">

  <link rel="icon" href="./_file/observable.1af93621.png" type="image/png" sizes="32x32">
  <script>
    sessionStorage.setItem("observablehq-sidebar", "false");
  </script>
  <script type="module">
    import { inject } from 'https://esm.sh/@vercel/analytics@1.5.0';
    inject();
  </script>
  
<script type="module">

import {define} from "./_observablehq/client.3714645d.js";
import {registerFile} from "./_observablehq/stdlib.73a8ec5a.js";

registerFile("./data/co2-mm-mlo.csv", {"name":"./data/co2-mm-mlo.csv","mimeType":"text/csv","path":"./_file/data/co2-mm-mlo.894efb21.csv","lastModified":1761137951924,"size":37957});

define({id: "9b832c91", inputs: ["FileAttachment"], outputs: ["co2Raw","co2Data","latestReading","firstReading","increase","yearsElapsed","avgRate"], body: async (FileAttachment) => {
const co2Raw = FileAttachment("./data/co2-mm-mlo.csv").csv({typed: true});
const co2Data = (await co2Raw).map(d => ({
  date: new Date(d.Date),
  year: d["Decimal Date"],
  yearInt: Math.floor(d["Decimal Date"]),
  month: new Date(d.Date).getMonth() + 1,
  average: +d.Average,
  interpolated: +d.Interpolated,
  trend: +d.Trend > 0 ? +d.Trend : null
})).filter(d => !isNaN(d.average) && d.average > 0);

const latestReading = co2Data[co2Data.length - 1];
const firstReading = co2Data[0];
const increase = latestReading.average - firstReading.average;
const yearsElapsed = latestReading.year - firstReading.year;
const avgRate = increase / yearsElapsed;
return {co2Raw,co2Data,latestReading,firstReading,increase,yearsElapsed,avgRate};
}});

define({id: "951a7949", inputs: ["html","Inputs"], outputs: ["Scrubber"], body: (html,Inputs) => {
function Scrubber(values, {format = value => value, initial = 0, direction = 1, delay = null, autoplay = true, loop = true, loopDelay = null, alternate = false} = {}) {
  values = Array.from(values);
  const form = html`<form style="font: 9px var(--sans-serif); display: flex; flex-direction: column; gap: 0.35rem;"><button name=b type=button style="width: 100%; padding: 0.25rem; font-size: 9px;"></button><label style="display: flex; flex-direction: column; gap: 0.2rem;"><input name=i type=range min=0 max=${values.length - 1} value=${initial} step=1 style="width: 100%;"><output name=o style="font-size: 10px; font-weight: 600; text-align: center;"></output></label></form>`;
  let frame = null, timer = null, interval = null;
  const start = () => { form.b.textContent = "Pause"; if (delay === null) frame = requestAnimationFrame(tick); else interval = setInterval(tick, delay); };
  const stop = () => { form.b.textContent = "Play"; if (frame !== null) cancelAnimationFrame(frame), frame = null; if (timer !== null) clearTimeout(timer), timer = null; if (interval !== null) clearInterval(interval), interval = null; };
  const running = () => frame !== null || timer !== null || interval !== null;
  const step = () => { form.i.valueAsNumber = (form.i.valueAsNumber + direction + values.length) % values.length; form.i.dispatchEvent(new CustomEvent("input", {bubbles: true})); };
  const tick = () => { if (form.i.valueAsNumber === (direction > 0 ? values.length - 1 : direction < 0 ? 0 : NaN)) { if (!loop) return stop(); if (alternate) direction = -direction; if (loopDelay !== null) { if (frame !== null) cancelAnimationFrame(frame), frame = null; if (interval !== null) clearInterval(interval), interval = null; timer = setTimeout(() => (step(), start()), loopDelay); return; } } if (delay === null) frame = requestAnimationFrame(tick); step(); };
  form.i.oninput = event => { if (event && event.isTrusted && running()) stop(); form.value = values[form.i.valueAsNumber]; form.o.value = format(form.value, form.i.valueAsNumber, values); };
  form.b.onclick = () => { if (running()) return stop(); direction = alternate && form.i.valueAsNumber === values.length - 1 ? -1 : 1; form.i.valueAsNumber = (form.i.valueAsNumber + direction) % values.length; form.i.dispatchEvent(new CustomEvent("input", {bubbles: true})); start(); };
  form.i.oninput();
  if (autoplay) start(); else stop();
  Inputs.disposal(form).then(stop);
  return form;
}
return {Scrubber};
}});

define({id: "1c2c4eba", inputs: ["d3","latestReading","view","Scrubber"], outputs: ["dashboardYears","selectedDashboardYear"], body: (d3,latestReading,view,Scrubber) => {
const dashboardYears = d3.range(1958, Math.floor(latestReading.year) + 1);
const selectedDashboardYear = view(Scrubber(dashboardYears, {
  delay: 100,
  loop: false,
  initial: dashboardYears.length - 1,
  autoplay: false,
  format: d => String(d)
}));
return {dashboardYears,selectedDashboardYear};
}});

define({id: "ee74cfd8", inputs: ["co2Data","selectedDashboardYear","d3","firstReading"], outputs: ["yearData","yearAvg","increaseFromStart","yearsFromStart","rateToDate","filteredData","recentYears","recentRate"], body: (co2Data,selectedDashboardYear,d3,firstReading) => {
const yearData = co2Data.filter(d => d.yearInt === selectedDashboardYear);
const yearAvg = yearData.length > 0 ? d3.mean(yearData, d => d.average) : firstReading.average;
const increaseFromStart = yearAvg - firstReading.average;
const yearsFromStart = selectedDashboardYear - Math.floor(firstReading.year);
const rateToDate = yearsFromStart > 0 ? increaseFromStart / yearsFromStart : 0;

const filteredData = co2Data.filter(d => d.yearInt <= selectedDashboardYear);
const recentYears = filteredData.filter(d => d.yearInt >= selectedDashboardYear - 10);
const recentRate = recentYears.length > 10 ? (recentYears[recentYears.length - 1].average - recentYears[0].average) / 10 : 0;
return {yearData,yearAvg,increaseFromStart,yearsFromStart,rateToDate,filteredData,recentYears,recentRate};
}});

define({id: "27bf356b", mode: "inline", inputs: ["yearAvg","display"], body: async (yearAvg,display) => {
display(await(
yearAvg.toFixed(1)
))
}});

define({id: "73717c36", mode: "inline", inputs: ["selectedDashboardYear","display"], body: async (selectedDashboardYear,display) => {
display(await(
selectedDashboardYear
))
}});

define({id: "49945493", mode: "inline", inputs: ["increaseFromStart","display"], body: async (increaseFromStart,display) => {
display(await(
increaseFromStart.toFixed(1)
))
}});

define({id: "3cc10d89", mode: "inline", inputs: ["rateToDate","display"], body: async (rateToDate,display) => {
display(await(
rateToDate.toFixed(2)
))
}});

define({id: "d7ba896f", mode: "inline", inputs: ["recentRate","avgRate","display"], body: async (recentRate,avgRate,display) => {
display(await(
recentRate > 0 ? recentRate.toFixed(2) : avgRate.toFixed(2)
))
}});

define({id: "4c724101", mode: "inline", inputs: ["latestReading","display"], body: async (latestReading,display) => {
display(await(
latestReading.average.toFixed(0)
))
}});

define({id: "7ea4c398", inputs: ["d3","latestReading","filteredData","selectedDashboardYear"], outputs: ["keelingCurve"], body: (d3,latestReading,filteredData,selectedDashboardYear) => {
function keelingCurve({width} = {}) {
  const isMobile = width < 640;
  const height = isMobile ? 320 : 340;
  const marginTop = 20;
  const marginRight = isMobile ? 35 : 45;
  const marginBottom = isMobile ? 50 : 50;
  const marginLeft = isMobile ? 50 : 60;

  const xScale = d3.scaleLinear()
    .domain([1958, Math.ceil(latestReading.year)])
    .range([marginLeft, width - marginRight]);

  const yScale = d3.scaleLinear()
    .domain([310, Math.max(435, latestReading.average + 5)])
    .range([height - marginBottom, marginTop])
    .nice();

  const line = d3.line()
    .x(d => xScale(d.year))
    .y(d => yScale(d.average))
    .curve(d3.curveCatmullRom);

  const container = d3.create("div")
    .style("position", "relative");

  const svg = container.append("svg")
    .attr("width", width)
    .attr("height", height)
    .attr("viewBox", [0, 0, width, height])
    .attr("style", "max-width: 100%; height: auto; background: white; display: block;");

  const tooltip = container.append("div")
    .style("position", "absolute")
    .style("visibility", "hidden")
    .style("background", "white")
    .style("border", "1px solid #ccc")
    .style("border-radius", "4px")
    .style("padding", "8px")
    .style("font-size", "12px")
    .style("font-family", "system-ui, sans-serif")
    .style("pointer-events", "none")
    .style("box-shadow", "0 2px 4px rgba(0,0,0,0.1)")
    .style("z-index", "1000")
    .style("line-height", "1.5");

  svg.append("g")
    .attr("class", "grid")
    .attr("transform", `translate(0,${height - marginBottom})`)
    .call(d3.axisBottom(xScale)
      .tickFormat("")
      .tickSize(-(height - marginTop - marginBottom)))
    .call(g => g.select(".domain").remove())
    .call(g => g.selectAll(".tick line")
      .attr("stroke", "#e5e7eb")
      .attr("stroke-opacity", 0.7));

  svg.append("g")
    .attr("class", "grid")
    .attr("transform", `translate(${marginLeft},0)`)
    .call(d3.axisLeft(yScale)
      .tickFormat("")
      .tickSize(-(width - marginLeft - marginRight)))
    .call(g => g.select(".domain").remove())
    .call(g => g.selectAll(".tick line")
      .attr("stroke", "#e5e7eb")
      .attr("stroke-opacity", 0.7));

  svg.append("g")
    .attr("transform", `translate(0,${height - marginBottom})`)
    .call(d3.axisBottom(xScale).tickFormat(d3.format("d")).ticks(isMobile ? 5 : 10).tickSize(0).tickPadding(8))
    .call(g => g.select(".domain").attr("stroke", "#ccc"))
    .call(g => g.selectAll("text").attr("font-size", isMobile ? "10px" : "11px"));

  svg.append("g")
    .attr("transform", `translate(${marginLeft},0)`)
    .call(d3.axisLeft(yScale).ticks(isMobile ? 5 : 7).tickSize(0).tickPadding(6).tickFormat(d => `${d}`))
    .call(g => g.select(".domain").attr("stroke", "#ccc"))
    .call(g => g.selectAll("text").attr("font-size", isMobile ? "10px" : "11px"));

  svg.append("text")
    .attr("x", marginLeft)
    .attr("y", marginTop - 5)
    .attr("fill", "currentColor")
    .attr("font-size", isMobile ? "9px" : "10px")
    .text("PPM");

  svg.append("defs").append("linearGradient")
    .attr("id", "areaGradient")
    .attr("x1", "0%").attr("y1", "0%")
    .attr("x2", "0%").attr("y2", "100%")
    .selectAll("stop")
    .data([
      {offset: "0%", color: "#0ea5e9", opacity: 0.3},
      {offset: "100%", color: "#22c55e", opacity: 0.1}
    ])
    .join("stop")
    .attr("offset", d => d.offset)
    .attr("stop-color", d => d.color)
    .attr("stop-opacity", d => d.opacity);

  const area = d3.area()
    .x(d => xScale(d.year))
    .y0(height - marginBottom)
    .y1(d => yScale(d.average))
    .curve(d3.curveCatmullRom);

  svg.append("path")
    .datum(filteredData)
    .attr("fill", "url(#areaGradient)")
    .attr("d", area);

  svg.append("path")
    .datum(filteredData)
    .attr("fill", "none")
    .attr("stroke", "#0ea5e9")
    .attr("stroke-width", 2.5)
    .attr("d", line);

  const hoverCircle = svg.append("circle")
    .attr("r", 5)
    .attr("fill", "#0ea5e9")
    .attr("stroke", "white")
    .attr("stroke-width", 2)
    .style("visibility", "hidden")
    .style("pointer-events", "none");

  svg.append("rect")
    .attr("x", marginLeft)
    .attr("y", marginTop)
    .attr("width", width - marginLeft - marginRight)
    .attr("height", height - marginTop - marginBottom)
    .attr("fill", "none")
    .attr("pointer-events", "all")
    .on("mousemove", function(event) {
      const [mx] = d3.pointer(event, svg.node());
      const year = xScale.invert(mx);

      const bisect = d3.bisector(d => d.year).left;
      const index = bisect(filteredData, year);
      const d0 = filteredData[index - 1];
      const d1 = filteredData[index];

      if (!d0 && !d1) return;

      const d = !d0 ? d1 : !d1 ? d0 : year - d0.year > d1.year - year ? d1 : d0;

      const dataX = xScale(d.year);
      const dataY = yScale(d.average);

      hoverCircle
        .attr("cx", dataX)
        .attr("cy", dataY)
        .style("visibility", "visible");

      const dateStr = d.date.toLocaleDateString('en-US', { month: 'short', year: 'numeric' });
      tooltip
        .html(`<strong>${dateStr}</strong><br/>COâ‚‚: ${d.average.toFixed(2)} PPM`)
        .style("visibility", "visible");

      const tooltipNode = tooltip.node();
      const tooltipWidth = tooltipNode.offsetWidth;
      const tooltipHeight = tooltipNode.offsetHeight;

      let left = dataX + 15;
      let top = dataY - tooltipHeight / 2;

      if (left + tooltipWidth > width - marginRight) {
        left = dataX - tooltipWidth - 15;
      }
      if (top < marginTop) top = marginTop;
      if (top + tooltipHeight > height - marginBottom) top = height - marginBottom - tooltipHeight;

      tooltip
        .style("left", `${left}px`)
        .style("top", `${top}px`);
    })
    .on("mouseout", () => {
      tooltip.style("visibility", "hidden");
      hoverCircle.style("visibility", "hidden");
    });

  if (selectedDashboardYear >= 1958) {
    svg.append("line")
      .attr("x1", xScale(selectedDashboardYear))
      .attr("x2", xScale(selectedDashboardYear))
      .attr("y1", marginTop)
      .attr("y2", height - marginBottom)
      .attr("stroke", "#f59e0b")
      .attr("stroke-width", 2)
      .attr("stroke-dasharray", "4,4");

    const yearPoint = filteredData[filteredData.length - 1];
    if (yearPoint) {
      svg.append("circle")
        .attr("cx", xScale(yearPoint.year))
        .attr("cy", yScale(yearPoint.average))
        .attr("r", 6)
        .attr("fill", "#dc2626")
        .attr("stroke", "white")
        .attr("stroke-width", 2);
    }
  }

  svg.append("line")
    .attr("x1", marginLeft)
    .attr("x2", width - marginRight)
    .attr("y1", yScale(280))
    .attr("y2", yScale(280))
    .attr("stroke", "#22c55e")
    .attr("stroke-width", 1.5)
    .attr("stroke-dasharray", "4,3")
    .attr("opacity", 0.5);

  svg.append("text")
    .attr("x", isMobile ? marginLeft + 5 : marginLeft + 35)
    .attr("y", yScale(280) - 5)
    .attr("fill", "#22c55e")
    .attr("font-size", isMobile ? "9px" : "10px")
    .text("Pre-industrial (280)");

  const legend = svg.append("g")
    .attr("transform", `translate(${width / 2 - 80}, ${height - (isMobile ? 15 : 12)})`);

  legend.append("line")
    .attr("x1", 0)
    .attr("x2", isMobile ? 18 : 25)
    .attr("y1", 0)
    .attr("y2", 0)
    .attr("stroke", "#0ea5e9")
    .attr("stroke-width", 2.5);

  legend.append("text")
    .attr("x", isMobile ? 22 : 30)
    .attr("y", 4)
    .attr("fill", "currentColor")
    .attr("font-size", isMobile ? "10px" : "11px")
    .text("Monthly Average COâ‚‚");

  return container.node();
}
return {keelingCurve};
}});

define({id: "a7afb378", inputs: ["d3","co2Data","selectedDashboardYear"], outputs: ["yearlyAverage","yearlyRates","filteredRates"], body: (d3,co2Data,selectedDashboardYear) => {
const yearlyAverage = d3.rollups(
  co2Data,
  v => d3.mean(v, d => d.average),
  d => d.yearInt
).map(([year, avg]) => ({ year, average: avg })).sort((a, b) => a.year - b.year);

const yearlyRates = yearlyAverage.slice(1).map((d, i) => ({
  year: d.year,
  rate: d.average - yearlyAverage[i].average
}));

const filteredRates = yearlyRates.filter(d => d.year <= selectedDashboardYear);
return {yearlyAverage,yearlyRates,filteredRates};
}});

define({id: "2f988d30", inputs: ["Plot","filteredRates","selectedDashboardYear"], outputs: ["rateOfIncreaseChart"], body: (Plot,filteredRates,selectedDashboardYear) => {
function rateOfIncreaseChart({width} = {}) {
  const isMobile = width < 640;

  return Plot.plot({
    width,
    height: isMobile ? 260 : 240,
    marginLeft: isMobile ? 40 : 50,
    marginRight: isMobile ? 20 : 30,
    marginBottom: isMobile ? 45 : 40,
    style: {
      fontSize: isMobile ? "11px" : "13px"
    },
    x: {
      label: null,
      grid: true,
      ticks: isMobile ? 5 : 8,
      tickFormat: d => String(d)
    },
    y: {
      label: "Annual Increase (PPM/year)",
      grid: true
    },
    marks: [
      Plot.ruleY([0], {stroke: "#94a3b8", strokeDasharray: "2,2"}),
      Plot.line(filteredRates, {
        x: "year",
        y: "rate",
        stroke: "#dc2626",
        strokeWidth: 2,
        curve: "catmull-rom"
      }),
      Plot.dot(filteredRates, {
        x: "year",
        y: "rate",
        r: 3,
        fill: "transparent",
        stroke: "transparent",
        tip: true,
        title: d => `Year: ${d.year}\nIncrease: ${d.rate.toFixed(3)} PPM/year`
      }),
      Plot.ruleX([selectedDashboardYear], {stroke: "#f59e0b", strokeWidth: 2, strokeDasharray: "4,4"}),
      Plot.dot(filteredRates.filter(d => d.year === selectedDashboardYear), {
        x: "year",
        y: "rate",
        fill: "#dc2626",
        stroke: "white",
        strokeWidth: 2,
        r: 6
      })
    ]
  });
}
return {rateOfIncreaseChart};
}});

define({id: "0e7a054f", inputs: ["yearAvg","selectedDashboardYear","recentRate"], outputs: ["thresholds","yearsTo450","projectedYear450"], body: (yearAvg,selectedDashboardYear,recentRate) => {
const thresholds = [
  { level: 280, label: "Pre-industrial", status: "passed", color: "#22c55e", description: "Natural baseline for 10,000+ years" },
  { level: 350, label: "Safe Climate Limit", status: "passed", color: "#f59e0b", description: "Exceeded ~1990, entering danger zone" },
  { level: yearAvg, label: "Current Level", status: "current", color: "#dc2626", description: `${selectedDashboardYear} measurement` },
  { level: 450, label: "Point of No Return", status: "approaching", color: "#7f1d1d", description: "2Â°C warming, irreversible tipping points" }
];

const yearsTo450 = recentRate > 0 ? Math.ceil((450 - yearAvg) / recentRate) : null;
const projectedYear450 = yearsTo450 ? selectedDashboardYear + yearsTo450 : null;
return {thresholds,yearsTo450,projectedYear450};
}});

define({id: "dea13c23", inputs: ["d3","yearAvg","projectedYear450","selectedDashboardYear","yearsTo450"], outputs: ["thresholdsChart"], body: (d3,yearAvg,projectedYear450,selectedDashboardYear,yearsTo450) => {
function thresholdsChart({width} = {}) {
  const isMobile = width < 640;
  const height = isMobile ? 280 : 260;
  const marginTop = 25;
  const marginRight = isMobile ? 15 : 20;
  const marginBottom = isMobile ? 40 : 35;
  const marginLeft = isMobile ? 45 : 55;

  const container = d3.create("div")
    .style("position", "relative");

  const svg = container.append("svg")
    .attr("width", width)
    .attr("height", height)
    .attr("viewBox", [0, 0, width, height])
    .style("background", "white")
    .style("display", "block");

  const yScale = d3.scaleLinear()
    .domain([250, 480])
    .range([height - marginBottom, marginTop]);

  const barWidth = Math.min(width * 0.35, 120);
  const barX = marginLeft + 20;

  svg.append("g")
    .attr("transform", `translate(${marginLeft},0)`)
    .call(d3.axisLeft(yScale).ticks(6).tickSize(0).tickPadding(6))
    .call(g => g.select(".domain").remove())
    .call(g => g.selectAll("text").attr("font-size", isMobile ? "10px" : "11px"));

  svg.append("text")
    .attr("x", marginLeft - 8)
    .attr("y", marginTop - 10)
    .attr("fill", "currentColor")
    .attr("font-size", isMobile ? "9px" : "10px")
    .attr("text-anchor", "end")
    .text("PPM");

  const zones = [
    { y0: 250, y1: 280, color: "#dcfce7", label: "" },
    { y0: 280, y1: 350, color: "#fef9c3", label: "" },
    { y0: 350, y1: 450, color: "#fed7aa", label: "" },
    { y0: 450, y1: 480, color: "#fecaca", label: "" }
  ];

  zones.forEach(zone => {
    svg.append("rect")
      .attr("x", barX)
      .attr("y", yScale(zone.y1))
      .attr("width", barWidth)
      .attr("height", yScale(zone.y0) - yScale(zone.y1))
      .attr("fill", zone.color)
      .attr("stroke", "#e5e7eb")
      .attr("stroke-width", 0.5);
  });

  svg.append("rect")
    .attr("x", barX)
    .attr("y", yScale(yearAvg))
    .attr("width", barWidth)
    .attr("height", yScale(280) - yScale(yearAvg))
    .attr("fill", "#dc2626")
    .attr("fill-opacity", 0.7);

  const thresholdLines = [
    { level: 280, label: "Pre-industrial (280)", color: "#22c55e" },
    { level: 350, label: "Safe Limit (350)", color: "#f59e0b" },
    { level: 450, label: "Point of No Return (450)", color: "#7f1d1d" }
  ];

  thresholdLines.forEach(t => {
    svg.append("line")
      .attr("x1", barX - 5)
      .attr("x2", barX + barWidth + 5)
      .attr("y1", yScale(t.level))
      .attr("y2", yScale(t.level))
      .attr("stroke", t.color)
      .attr("stroke-width", 2)
      .attr("stroke-dasharray", t.level === 450 ? "4,3" : "0");

    svg.append("text")
      .attr("x", barX + barWidth + 10)
      .attr("y", yScale(t.level) + 4)
      .attr("fill", t.color)
      .attr("font-size", isMobile ? "9px" : "10px")
      .attr("font-weight", "600")
      .text(t.label);
  });

  svg.append("line")
    .attr("x1", barX - 8)
    .attr("x2", barX + barWidth + 8)
    .attr("y1", yScale(yearAvg))
    .attr("y2", yScale(yearAvg))
    .attr("stroke", "#dc2626")
    .attr("stroke-width", 3);

  svg.append("circle")
    .attr("cx", barX - 12)
    .attr("cy", yScale(yearAvg))
    .attr("r", 5)
    .attr("fill", "#dc2626")
    .attr("stroke", "white")
    .attr("stroke-width", 2);

  svg.append("text")
    .attr("x", barX + barWidth + 10)
    .attr("y", yScale(yearAvg) + 4)
    .attr("fill", "#dc2626")
    .attr("font-size", isMobile ? "10px" : "11px")
    .attr("font-weight", "bold")
    .text(`Current: ${yearAvg.toFixed(1)} PPM`);

  if (projectedYear450 && projectedYear450 > selectedDashboardYear) {
    svg.append("text")
      .attr("x", barX + barWidth / 2)
      .attr("y", height - 8)
      .attr("text-anchor", "middle")
      .attr("fill", "#7f1d1d")
      .attr("font-size", isMobile ? "9px" : "10px")
      .attr("font-weight", "600")
      .text(`~${yearsTo450} years to 450 PPM (by ${projectedYear450})`);
  }

  return container.node();
}
return {thresholdsChart};
}});

define({id: "8d3b1e41", inputs: ["d3","co2Data","selectedDashboardYear"], outputs: ["decadeData","filteredDecades"], body: (d3,co2Data,selectedDashboardYear) => {
const decadeData = d3.rollups(
  co2Data,
  v => d3.mean(v, d => d.average),
  d => Math.floor(d.yearInt / 10) * 10
).map(([decade, avg]) => ({
  decade: `${decade}s`,
  decadeNum: decade,
  average: avg
})).sort((a, b) => a.decadeNum - b.decadeNum);

const filteredDecades = decadeData.filter(d => d.decadeNum <= Math.floor(selectedDashboardYear / 10) * 10);
return {decadeData,filteredDecades};
}});

define({id: "6c0c447a", inputs: ["selectedDashboardYear","Plot","filteredDecades"], outputs: ["decadeComparison"], body: (selectedDashboardYear,Plot,filteredDecades) => {
function decadeComparison({width} = {}) {
  const isMobile = width < 640;
  const currentDecade = Math.floor(selectedDashboardYear / 10) * 10;

  return Plot.plot({
    width,
    height: isMobile ? 260 : 240,
    marginLeft: isMobile ? 40 : 50,
    marginRight: isMobile ? 20 : 30,
    marginBottom: isMobile ? 60 : 55,
    style: {
      fontSize: isMobile ? "11px" : "13px"
    },
    x: {
      label: null,
      tickRotate: -45
    },
    y: {
      label: "Average COâ‚‚ (PPM)",
      grid: true
    },
    marks: [
      Plot.barY(filteredDecades, {
        x: "decade",
        y: "average",
        fill: d => d.decadeNum === currentDecade ? "#f59e0b" : "#3b82f6",
        fillOpacity: d => d.decadeNum === currentDecade ? 1 : 0.7,
        stroke: d => d.decadeNum === currentDecade ? "white" : "none",
        strokeWidth: 2,
        tip: true,
        title: d => `${d.decade}\nAverage: ${d.average.toFixed(2)} PPM`
      }),
      Plot.ruleY([0])
    ]
  });
}
return {decadeComparison};
}});

define({id: "f15f43bb", mode: "inline", inputs: ["resize","keelingCurve","display"], body: async (resize,keelingCurve,display) => {
display(await(
resize((width) => keelingCurve({width}))
))
}});

define({id: "130fc8b0", mode: "inline", inputs: ["resize","rateOfIncreaseChart","display"], body: async (resize,rateOfIncreaseChart,display) => {
display(await(
resize((width) => rateOfIncreaseChart({width}))
))
}});

define({id: "3337026d", mode: "inline", inputs: ["resize","thresholdsChart","display"], body: async (resize,thresholdsChart,display) => {
display(await(
resize((width) => thresholdsChart({width}))
))
}});

define({id: "073a6891", mode: "inline", inputs: ["resize","decadeComparison","display"], body: async (resize,decadeComparison,display) => {
display(await(
resize((width) => decadeComparison({width}))
))
}});

</script>
</head>
<body>
<div id="observablehq-center">
<main id="observablehq-main" class="observablehq">
<div class="portaljs-banner">
  <div class="portaljs-banner-content">
    <span class="portaljs-banner-icon">ðŸŒ€</span>
    <div class="portaljs-banner-text">
      <p class="portaljs-banner-title">Create beautiful data portals with PortalJS</p>
      <p class="portaljs-banner-description"> The open-source framework for building data catalogs, dashboards, and visualizations.</p>
    </div>
  </div>
  <a href="https://www.portaljs.com/" target="_blank" rel="noopener noreferrer" class="portaljs-banner-cta">
    Get Started Free <span class="portaljs-banner-cta-arrow">â†’</span>
  </a>
</div>
<style>
.hero {
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  justify-content: center;
  padding: 0.5rem 0.75rem;
  background: var(--theme-background-alt);
  color: var(--theme-foreground);
  border-radius: 4px;
  margin-bottom: 0.75rem;
  border: 2px solid var(--theme-foreground-faint);
  overflow-anchor: none !important;
}

.hero h1 {
  margin: 0;
  font-size: 1.25rem;
  font-weight: 700;
  color: var(--theme-foreground-alt);
  max-width: 100%;
  line-height: 1.2;
}

.hero p {
  margin: 0.15rem 0 0;
  font-size: 0.7rem;
  color: var(--theme-foreground-muted);
  max-width: 100%;
  line-height: 1.3;
}

* {
  overflow-anchor: none !important;
}

body {
  overflow-anchor: none !important;
}

.card, .card > *, .card svg, .card figure {
  overflow-anchor: none !important;
  contain: layout style paint;
}

.card, .grid {
  max-width: 100% !important;
}

.chart-container {
  overflow-anchor: none !important;
  contain: layout style paint;
  min-height: 280px;
}

.chart-grid {
  overflow-anchor: none !important;
}

svg, svg * {
  overflow-anchor: none !important;
}

.dashboard-layout {
  display: grid;
  grid-template-columns: 210px 1fr;
  gap: 1rem;
  margin: 0 0 4rem 0;
  overflow-anchor: none !important;
  min-height: 0;
}

.sidebar {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
  padding-right: 0.5rem;
  border-right: 1px solid var(--theme-foreground-faint);
}

.stat-card {
  background: var(--theme-background-alt);
  border: 2px solid var(--theme-foreground-faint);
  border-radius: 4px;
  padding: 0.5rem;
  text-align: left;
  overflow-anchor: none !important;
  min-height: 60px;
}

.stat-value {
  font-size: 1.3rem;
  font-weight: 900;
  color: var(--theme-foreground-alt);
  margin: 0.1rem 0;
  line-height: 1.1;
}

.stat-label {
  font-size: 0.6rem;
  color: var(--theme-foreground-muted);
  text-transform: uppercase;
  letter-spacing: 0.03em;
  font-weight: 600;
  line-height: 1.2;
}

.stat-change {
  font-size: 0.6rem;
  font-weight: 500;
  margin-top: 0.1rem;
  color: var(--theme-foreground-muted);
  line-height: 1.2;
}

.positive { color: #dc2626; }
.negative { color: #059669; }

.main-content {
  display: flex;
  flex-direction: column;
  gap: 0;
  min-height: 400px;
  background: white;
  border: 1px solid var(--theme-foreground-faint);
  border-radius: 6px;
  overflow: visible;
}

.chart-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 0;
  overflow-anchor: none !important;
  contain: layout;
}

.chart-grid .chart-container {
  border: none;
  border-radius: 0;
  position: relative;
}

.chart-grid .chart-container:not(:last-child)::after {
  content: "";
  position: absolute;
  right: 0;
  top: 0;
  bottom: 0;
  width: 1px;
  background: #e5e7eb;
}

.chart-large {
  min-height: 380px !important;
  border-left: none !important;
  border-right: none !important;
  border-top: none !important;
  border-bottom: none !important;
  border-radius: 0 !important;
  margin-bottom: 0;
  position: relative;
}

.chart-large::after {
  content: "";
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  height: 1px;
  background: #e5e7eb;
}

.chart-wide {
  grid-column: 1 / -1;
}

@media (max-width: 1200px) {
  .chart-grid {
    grid-template-columns: 1fr 1fr;
  }
}

@media (max-width: 1024px) {
  .dashboard-layout {
    grid-template-columns: 1fr;
  }

  .sidebar {
    flex-direction: row;
    flex-wrap: wrap;
    border-right: none;
    border-bottom: 1px solid var(--theme-foreground-faint);
    padding-right: 0;
    padding-bottom: 0.75rem;
  }

  .controls-section {
    width: 100%;
  }

  .stat-card {
    flex: 1;
    min-width: 180px;
  }
}

@media (max-width: 768px) {
  .chart-grid {
    grid-template-columns: 1fr;
  }

  .chart-grid .chart-container:not(:last-child)::after {
    width: 100%;
    height: 1px;
    right: auto;
    left: 0;
    top: auto;
    bottom: 0;
  }

  .chart-container {
    min-height: 280px;
  }

  .sidebar {
    flex-direction: column;
  }

  .stat-card {
    min-width: auto;
  }

  .dashboard-layout {
    max-height: none;
  }

  .main-content {
    max-height: none;
  }
}

.chart-container {
  background: white;
  border: none;
  border-radius: 0;
  padding: 0.6rem;
}

.chart-container h3 {
  margin: 0 0 0.4rem 0;
  font-size: 0.75rem;
  font-weight: 700;
  color: var(--theme-foreground);
  overflow-anchor: none !important;
}

.chart-container > * {
  overflow-anchor: none !important;
}

.controls-section {
  background: var(--theme-background-alt);
  border: 2px solid var(--theme-foreground-faint);
  border-radius: 4px;
  padding: 0.5rem;
}

.controls-section h3 {
  margin: 0 0 0.35rem 0;
  font-size: 0.6rem;
  font-weight: 700;
  color: var(--theme-foreground);
  text-transform: uppercase;
  letter-spacing: 0.03em;
}

.insights-section {
  background: var(--theme-background-alt);
  border: 2px solid var(--theme-foreground-faint);
  border-radius: 4px;
  padding: 0.6rem;
  font-size: 0.7rem;
  line-height: 1.35;
}

.insights-section h3 {
  margin: 0 0 0.4rem 0;
  font-size: 0.7rem;
  font-weight: 700;
  color: var(--theme-foreground);
  text-transform: uppercase;
  letter-spacing: 0.03em;
}

.insights-section ul {
  margin: 0;
  padding-left: 1rem;
  list-style-type: none;
}

.insights-section li {
  margin-bottom: 0.35rem;
  position: relative;
  padding-left: 0.4rem;
  font-size: 0.68rem;
  line-height: 1.4;
}

.insights-section li::before {
  content: "â€¢";
  position: absolute;
  left: -0.4rem;
  color: var(--theme-foreground-focus);
  font-weight: bold;
  font-size: 0.7rem;
}

.insights-section li:last-child {
  margin-bottom: 0;
}

.insights-section .data-sources {
  margin-top: 0.55rem;
  padding-top: 0.55rem;
  border-top: 1px solid var(--theme-foreground-faint);
  font-size: 0.62rem;
  color: var(--theme-foreground-muted);
  line-height: 1.35;
}

form, form * {
  overflow-anchor: none !important;
}
</style>
<div class="hero">
  <h1>Atmospheric COâ‚‚ Monitoring Dashboard</h1>
  <p>The Keeling Curve - Continuous atmospheric COâ‚‚ measurements from Mauna Loa Observatory, Hawaii (1958-Present)</p>
</div>
<div class="observablehq observablehq--block"><!--:9b832c91:--></div>
<div class="observablehq observablehq--block"><!--:951a7949:--></div>
<div class="dashboard-layout">
  <div class="sidebar">
    <div class="controls-section">
      <h3>Timeline</h3>
<div class="observablehq observablehq--block"><!--:1c2c4eba:--></div>
  </div>
<div class="observablehq observablehq--block"><!--:ee74cfd8:--></div>
  <div class="stat-card">
    <div class="stat-label">Current COâ‚‚</div>
    <div class="stat-value positive"><observablehq-loading></observablehq-loading><!--:27bf356b:--></div>
    <div class="stat-change">PPM (<observablehq-loading></observablehq-loading><!--:73717c36:-->)</div>
  </div>
  <div class="stat-card">
    <div class="stat-label">Increase</div>
    <div class="stat-value positive">+<observablehq-loading></observablehq-loading><!--:49945493:--></div>
    <div class="stat-change">PPM Since 1958</div>
  </div>
  <div class="stat-card">
    <div class="stat-label">Average Rate</div>
    <div class="stat-value positive"><observablehq-loading></observablehq-loading><!--:3cc10d89:--></div>
    <div class="stat-change">PPM/Year</div>
  </div>
  <div class="stat-card">
    <div class="stat-label">Recent Trend</div>
    <div class="stat-value positive"><observablehq-loading></observablehq-loading><!--:d7ba896f:--></div>
    <div class="stat-change">PPM/Year (10yr)</div>
  </div>
  <div class="insights-section">
    <h3>Key Insights</h3>
    <ul>
      <li><strong>Safe Limit (350 PPM):</strong> Exceeded ~1990, we are now in the climate danger zone</li>
      <li><strong>Point of No Return (450 PPM):</strong> Approaching in ~10-15 years at current rate, triggers irreversible tipping points</li>
      <li><strong>Pre-industrial:</strong> COâ‚‚ was ~280 PPM for 10,000+ years before industrialization</li>
      <li><strong>Current Level:</strong> Now above <observablehq-loading></observablehq-loading><!--:4c724101:--> PPM - causing record heat and extreme weather</li>
      <li><strong>Acceleration:</strong> Rate of increase has nearly doubled from 1960s to today</li>
      <li><strong>Indoor Risk:</strong> At 1,000+ PPM cognitive function declines - rising outdoor levels make indoor air harder to keep fresh</li>
    </ul>
    <div class="data-sources">
      <strong>Data:</strong> <a href="https://datahub.io/core/co2-ppm" target="_blank" rel="noopener noreferrer">Scripps Institution of Oceanography</a>, NOAA Earth System Research Laboratory
    </div>
  </div>
  </div>
  <div class="main-content">
<div class="observablehq observablehq--block"><!--:7ea4c398:--></div>
<div class="observablehq observablehq--block"><!--:a7afb378:--></div>
<div class="observablehq observablehq--block"><!--:2f988d30:--></div>
<div class="observablehq observablehq--block"><!--:0e7a054f:--></div>
<div class="observablehq observablehq--block"><!--:dea13c23:--></div>
<div class="observablehq observablehq--block"><!--:8d3b1e41:--></div>
<div class="observablehq observablehq--block"><!--:6c0c447a:--></div>
<div class="chart-container chart-large">
  <h3>The Keeling Curve - Atmospheric COâ‚‚ (1958-Present)</h3>
  <observablehq-loading></observablehq-loading><!--:f15f43bb:-->
</div>
<div class="chart-grid">
  <div class="chart-container">
    <h3>Annual Rate of Increase</h3>
    <observablehq-loading></observablehq-loading><!--:130fc8b0:-->
  </div>
  <div class="chart-container">
    <h3>Critical COâ‚‚ Thresholds</h3>
    <observablehq-loading></observablehq-loading><!--:3337026d:-->
  </div>
  <div class="chart-container">
    <h3>Decade Average Comparison</h3>
    <observablehq-loading></observablehq-loading><!--:073a6891:-->
  </div>
</div>
  </div>
</div>
</main>
<footer id="observablehq-footer">
<nav><a rel="prev" href="./co2-emissions-nations"><span>Global CO2 Emissions by Nation</span></a><a rel="next" href="./global-warming-dashboard"><span>Global Warming Effects Dashboard</span></a></nav>
<div>Built with Observable Framework. Sources: NASA GISTEMP, CSIRO, WGMS, Scripps COâ‚‚.</div>
</footer>
</div>
</body>
</html>
